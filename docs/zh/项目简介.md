# ObjectOS 项目简介

## 项目定位

**ObjectOS** 是新一代 AI 时代的元数据驱动企业应用运行时平台，是 Salesforce 和 Airtable 的开源替代方案。

### 核心理念

> "ObjectQL 定义标准，ObjectOS 解释执行"

- **ObjectQL**：企业应用元数据标准协议（位于 `github.com/objectql/objectql`）
  - 定义数据模型、业务规则、权限控制的统一规范
  - 通过简单的 YAML 文件描述复杂的企业应用逻辑
  - 跨平台、跨语言的元数据标准

- **ObjectOS**：元数据运行时引擎（本项目）
  - 解析和执行 ObjectQL 元数据
  - 自动生成后端 API 和前端界面
  - 提供完整的企业应用运行时环境

### 一句话概括

通过标准化的元数据描述（ObjectQL），零代码/低代码生成海量企业应用（ObjectOS）。

---

## 项目价值

### 1. **统一的元数据标准**

传统企业软件开发面临的问题：
- 每个系统有自己的数据模型定义方式
- 业务逻辑散落在代码各处，难以维护
- 权限控制实现方式千差万别

ObjectQL 提供：
- ✅ 统一的 `.object.yml` 格式定义所有业务对象
- ✅ 声明式的验证规则、公式字段、触发器
- ✅ 内置的 RBAC（基于角色）和 RLS（行级安全）

### 2. **极致的开发效率**

传统开发流程：
```
需求分析 → 数据库设计 → 后端开发 → 前端开发 → 联调测试
（耗时：数周到数月）
```

ObjectOS 开发流程：
```
编写 object.yml → 运行 ObjectOS → 完成！
（耗时：数分钟到数小时）
```

### 3. **企业级的开箱即用能力**

ObjectOS 内置：
- 🔐 **身份认证**：集成 Better-Auth，支持多种登录方式
- 🛡️ **权限系统**：字段级、记录级权限控制
- 📊 **数据表格**：基于 TanStack Table 的高性能数据网格
- 📝 **表单引擎**：自动生成的企业级详情表单
- 🔄 **工作流**：内置流程自动化引擎
- 📁 **文件存储**：支持附件上传和管理

### 4. **AI 时代的执行层**

在 AI 辅助开发的时代：
- AI 可以理解需求并生成 `object.yml` 元数据
- ObjectOS 负责稳定、高效地执行这些元数据
- 人类只需审核元数据，无需编写大量样板代码

---

## 技术架构

### 整体架构图

```
┌─────────────────────────────────────────────────────────────┐
│                     ObjectOS 生态系统                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────┐    ┌──────────────┐    ┌─────────────┐  │
│  │   元数据定义   │───▶│  运行时引擎   │───▶│  企业应用    │  │
│  │  (ObjectQL)   │    │  (ObjectOS)   │    │   (生成)    │  │
│  └──────────────┘    └──────────────┘    └─────────────┘  │
│                                                             │
│  *.object.yml      解析+执行+渲染        全栈应用          │
│  *.app.yml         Kernel + Server     后端API + 前端UI    │
│  *.data.yml        + Plugins                               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 核心架构原则

> **"Kernel 处理逻辑，Driver 处理数据，Server 处理 HTTP"**

#### 1. **Kernel（内核层）**
- **职责**：业务逻辑编排、权限校验、生命周期管理
- **技术栈**：TypeScript + 插件系统
- **包名**：`@objectos/kernel`
- **特点**：
  - 数据库无关（依赖注入）
  - 纯逻辑处理，不涉及 I/O
  - 支持 Hook 机制扩展

#### 2. **Driver（驱动层）**
- **职责**：数据持久化、查询优化、事务管理
- **技术栈**：Knex.js（PostgreSQL）、Mongoose（MongoDB）
- **来源**：`@objectql/driver-*` 系列包（外部仓库）
- **特点**：
  - 实现统一的 `ObjectQLDriver` 接口
  - 针对不同数据库的优化策略
  - 支持关系型和文档型数据库

#### 3. **Server（服务层）**
- **职责**：HTTP 请求处理、认证授权、API 暴露
- **技术栈**：NestJS + Express
- **包名**：`@objectos/server`
- **特点**：
  - RESTful API 自动生成
  - 支持 GraphQL（规划中）
  - 集成 Swagger 文档

#### 4. **UI（界面层）**
- **职责**：数据展示、表单渲染、用户交互
- **技术栈**：React + Shadcn UI + TanStack Table
- **应用**：`apps/web`
- **特点**：
  - 混合式界面（网格视图 + 详情抽屉）
  - 完全由元数据驱动
  - 支持主题定制

### 分层依赖关系

```
┌─────────────────────────────────────────┐
│          apps/web (前端应用)              │
│         (React + Shadcn UI)             │
└────────────────┬────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────┐
│      @objectos/server (API 层)          │
│           (NestJS)                      │
└────────────────┬────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────┐
│      @objectos/kernel (业务逻辑层)       │
│      + @objectos/plugin-* (插件)        │
└────────────────┬────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────────┐
│    @objectql/driver-* (数据访问层)       │
│     (PostgreSQL / MongoDB)              │
└────────────────┬────────────────────────┘
                 │
                 ▼
           ┌──────────┐
           │ Database │
           └──────────┘
```

### Monorepo 项目结构

```
objectos/
├── packages/
│   ├── kernel/          # 核心运行时引擎
│   ├── server/          # NestJS HTTP 服务
│   ├── ui/              # React 组件库
│   ├── plugin-auth/     # 身份认证插件
│   ├── plugin-workflow/ # 工作流插件
│   └── preset-*/        # 预设元数据包（如 CRM、HR）
├── apps/
│   └── web/             # 统一前端应用
├── examples/
│   ├── crm-demo/        # CRM 示例
│   └── project-mgmt/    # 项目管理示例
└── docs/                # 文档站点（VitePress）
```

---

## 核心特性

### 1. **元数据驱动的全栈生成**

**输入：** 一个 `contact.object.yml` 文件

```yaml
name: contacts
label: 联系人
icon: user
fields:
  name:
    type: text
    label: 姓名
    required: true
  email:
    type: email
    label: 邮箱
    unique: true
  phone:
    type: phone
    label: 电话
  company:
    type: lookup
    reference: accounts
    label: 所属公司
```

**输出：**
- ✅ PostgreSQL 数据表自动创建
- ✅ RESTful API：`GET/POST/PUT/DELETE /api/v4/contacts`
- ✅ React 数据表格界面
- ✅ 详情表单自动渲染
- ✅ 字段级权限校验
- ✅ 数据验证规则

### 2. **混合式用户界面**

**网格视图**（类似 Airtable）：
- 海量数据高性能渲染（虚拟滚动）
- 列宽调整、排序、筛选
- 行内编辑、批量操作

**详情抽屉**（类似 Salesforce）：
- 点击任意行，右侧滑出详情表单
- 关联列表（Related Lists）
- 活动时间线（Activity Feed）

### 3. **企业级安全模型**

**基于角色的访问控制（RBAC）：**
```yaml
# 在 object.yml 中定义
permissions:
  admin:
    allowCreate: true
    allowRead: true
    allowEdit: true
    allowDelete: true
  sales:
    allowCreate: true
    allowRead: true
    allowEdit: own  # 只能编辑自己的记录
    allowDelete: false
```

**行级安全（RLS）：**
```yaml
# 共享规则
sharing:
  - role: sales_manager
    criteria:
      department: sales
    access: read_write
```

**字段级安全（FLS）：**
```yaml
fields:
  salary:
    type: currency
    visibleTo: [hr_admin, finance]
```

### 4. **AI 友好的设计**

- **结构化元数据**：YAML 格式易于 AI 理解和生成
- **声明式语法**：减少 AI 幻觉风险
- **渐进式复杂度**：从简单的 CRUD 到复杂的工作流
- **内置验证**：自动检查元数据正确性

---

## 与竞品对比

| 特性 | ObjectOS | Salesforce | Airtable | Odoo |
|------|----------|------------|----------|------|
| **开源** | ✅ MIT | ❌ 闭源 | ❌ 闭源 | ✅ LGPL/商业双授权 |
| **元数据标准** | ✅ ObjectQL | 专有格式 | 专有格式 | Python 模块 |
| **混合界面** | ✅ 网格+详情 | ✅ 详情为主 | ✅ 网格为主 | ✅ 详情为主 |
| **数据库支持** | PostgreSQL, MongoDB | 专有数据库 | 专有数据库 | PostgreSQL |
| **部署方式** | 自托管/云 | 仅云端 | 仅云端 | 自托管/云 |
| **AI 集成** | ✅ 原生支持 | 有限支持 | 有限支持 | 有限支持 |
| **学习曲线** | 低（YAML） | 高（点击配置） | 低 | 高（Python） |
| **企业功能** | ✅ 完整 | ✅ 完整 | 部分 | ✅ 完整 |

---

## 适用场景

### ✅ 非常适合

1. **企业内部系统**
   - CRM（客户关系管理）
   - ERP（企业资源计划）
   - OA（办公自动化）
   - HRM（人力资源管理）

2. **SaaS 产品开发**
   - 快速 MVP 验证
   - 多租户架构
   - 需要频繁迭代的产品

3. **AI 应用开发**
   - AI Agent 的执行环境
   - 自动化生成的业务系统
   - 需要可解释性的 AI 应用

### ❌ 不适合

1. **高并发公共服务**（如社交网络、电商前台）
2. **实时系统**（如在线游戏、股票交易）
3. **复杂算法系统**（如推荐引擎、图像识别）

---

## 快速开始

### 安装

```bash
npx create-objectos-app my-company
cd my-company
npm install
```

### 定义第一个对象

创建 `objects/product.object.yml`：

```yaml
name: products
label: 产品
fields:
  name:
    type: text
    label: 产品名称
    required: true
  price:
    type: currency
    label: 价格
  stock:
    type: number
    label: 库存
```

### 启动应用

```bash
npm run dev
```

访问 `http://localhost:3000`，即可看到自动生成的产品管理界面！

---

## 技术亮点

### 1. **类型安全**
- 100% TypeScript 编写
- 完整的类型推导
- 运行时类型验证（Zod）

### 2. **可扩展性**
- 插件系统（类似 Vite）
- Hook 机制（类似 WordPress）
- 中间件支持（NestJS）

### 3. **性能优化**
- 查询计划优化（Driver 层）
- 虚拟滚动（UI 层）
- 增量编译（元数据热更新）

### 4. **开发者体验**
- 热模块替换（HMR）
- 完整的错误提示
- 内置调试工具

---

## 生态系统

### 官方包

| 包名 | 描述 | 状态 |
|------|------|------|
| `@objectos/kernel` | 核心运行时 | ✅ 稳定 |
| `@objectos/server` | HTTP 服务 | ✅ 稳定 |
| `@objectos/ui` | React 组件库 | 🚧 开发中 |
| `@objectos/plugin-auth` | 身份认证 | ✅ 稳定 |
| `@objectos/plugin-workflow` | 工作流引擎 | 🚧 开发中 |
| `@objectos/preset-crm` | CRM 预设包 | 📋 规划中 |

### 社区生态

- **Builder6.ai**：AI 驱动的可视化元数据编辑器
- **ObjectOS Cloud**：官方云托管服务（规划中）
- **Marketplace**：第三方插件市场（规划中）

---

## 开源协议

MIT License - 完全自由使用，包括商业项目。

---

## 参与贡献

我们正在构建开源企业软件的未来。欢迎：

- 🐛 提交 Issue
- 💡 提出功能建议
- 🔧 贡献代码
- 📖 完善文档

详见：[贡献指南](../../CONTRIBUTING.md)

---

## 相关资源

- 📚 [完整文档](https://objectos.org)
- 🎯 [ObjectQL 协议规范](https://github.com/objectql/objectql)
- 🤖 [AI Builder](https://www.builder6.ai)
- 💬 [社区讨论](https://github.com/objectql/objectos/discussions)

---

**ObjectOS - 让企业应用开发回归本质：描述业务，而非编写代码。**
